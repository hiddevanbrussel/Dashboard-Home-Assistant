{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/stores/theme-store.ts"],"sourcesContent":["import { create } from \"zustand\";\r\nimport { persist } from \"zustand/middleware\";\r\n\r\nexport type ThemeMode = \"auto\" | \"light\" | \"dark\";\r\n\r\ntype ThemeStore = {\r\n  mode: ThemeMode;\r\n  setMode: (mode: ThemeMode) => void;\r\n  resolved: \"light\" | \"dark\";\r\n  setResolved: (resolved: \"light\" | \"dark\") => void;\r\n};\r\n\r\nexport const useThemeStore = create<ThemeStore>()(\r\n  persist(\r\n    (set) => ({\r\n      mode: \"auto\",\r\n      resolved: \"light\",\r\n      setMode: (mode) => set({ mode }),\r\n      setResolved: (resolved) => set({ resolved }),\r\n    }),\r\n    { name: \"dashboard-theme\" }\r\n  )\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAWO,MAAM,gBAAgB,IAAA,qJAAM,IACjC,IAAA,2JAAO,EACL,CAAC,MAAQ,CAAC;QACR,MAAM;QACN,UAAU;QACV,SAAS,CAAC,OAAS,IAAI;gBAAE;YAAK;QAC9B,aAAa,CAAC,WAAa,IAAI;gBAAE;YAAS;IAC5C,CAAC,GACD;IAAE,MAAM;AAAkB","debugId":null}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/theme-provider.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useThemeStore } from \"@/stores/theme-store\";\r\nimport { useCallback, useEffect } from \"react\";\r\n\r\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\r\n  const { mode, resolved, setResolved } = useThemeStore();\r\n\r\n  const applyTheme = useCallback(() => {\r\n    const root = document.documentElement;\r\n    let next: \"light\" | \"dark\" = resolved;\r\n\r\n    if (mode === \"auto\") {\r\n      next =\r\n        typeof window !== \"undefined\" &&\r\n        window.matchMedia(\"(prefers-color-scheme: dark)\").matches\r\n          ? \"dark\"\r\n          : \"light\";\r\n    } else {\r\n      next = mode;\r\n    }\r\n\r\n    root.classList.remove(\"light\", \"dark\");\r\n    root.classList.add(next);\r\n    setResolved(next);\r\n  }, [mode, resolved, setResolved]);\r\n\r\n  useEffect(() => {\r\n    applyTheme();\r\n  }, [applyTheme]);\r\n\r\n  useEffect(() => {\r\n    if (mode !== \"auto\") return;\r\n    const mq = window.matchMedia(\"(prefers-color-scheme: dark)\");\r\n    const handler = () => applyTheme();\r\n    mq.addEventListener(\"change\", handler);\r\n    return () => mq.removeEventListener(\"change\", handler);\r\n  }, [mode, applyTheme]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen transition-theme duration-theme\" data-theme={resolved}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKO,SAAS,cAAc,KAA2C;QAA3C,EAAE,QAAQ,EAAiC,GAA3C;;IAC5B,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,GAAG,IAAA,mJAAa;IAErD,MAAM,aAAa,IAAA,4KAAW;iDAAC;YAC7B,MAAM,OAAO,SAAS,eAAe;YACrC,IAAI,OAAyB;YAE7B,IAAI,SAAS,QAAQ;gBACnB,OACE,aAAkB,eAClB,OAAO,UAAU,CAAC,gCAAgC,OAAO,GACrD,SACA;YACR,OAAO;gBACL,OAAO;YACT;YAEA,KAAK,SAAS,CAAC,MAAM,CAAC,SAAS;YAC/B,KAAK,SAAS,CAAC,GAAG,CAAC;YACnB,YAAY;QACd;gDAAG;QAAC;QAAM;QAAU;KAAY;IAEhC,IAAA,0KAAS;mCAAC;YACR;QACF;kCAAG;QAAC;KAAW;IAEf,IAAA,0KAAS;mCAAC;YACR,IAAI,SAAS,QAAQ;YACrB,MAAM,KAAK,OAAO,UAAU,CAAC;YAC7B,MAAM;mDAAU,IAAM;;YACtB,GAAG,gBAAgB,CAAC,UAAU;YAC9B;2CAAO,IAAM,GAAG,mBAAmB,CAAC,UAAU;;QAChD;kCAAG;QAAC;QAAM;KAAW;IAErB,qBACE,6LAAC;QAAI,WAAU;QAA+C,cAAY;kBACvE;;;;;;AAGP;GAvCgB;;QAC0B,mJAAa;;;KADvC","debugId":null}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/stores/screensaver-store.ts"],"sourcesContent":["const STORAGE_KEY_DELAY = \"dashboard.screensaverDelaySeconds\";\nconst STORAGE_KEY_LEGACY_MINUTES = \"dashboard.screensaverMinutes\";\nconst STORAGE_KEY_BACKGROUND = \"dashboard.screensaverBackground\";\n\n/** Screensaver timeout in seconden. 0 = disabled. */\nexport function getScreensaverDelaySeconds(): number {\n  if (typeof window === \"undefined\") return 0;\n  try {\n    let v = localStorage.getItem(STORAGE_KEY_DELAY);\n    if (v === null) {\n      const legacy = localStorage.getItem(STORAGE_KEY_LEGACY_MINUTES);\n      if (legacy !== null) {\n        const min = parseInt(legacy, 10);\n        if (Number.isFinite(min) && min >= 0) {\n          const sec = min * 60;\n          localStorage.setItem(STORAGE_KEY_DELAY, String(sec));\n          localStorage.removeItem(STORAGE_KEY_LEGACY_MINUTES);\n          return sec;\n        }\n      }\n      return 0;\n    }\n    const n = parseInt(v, 10);\n    return Number.isFinite(n) && n >= 0 ? n : 0;\n  } catch {\n    return 0;\n  }\n}\n\nexport function setScreensaverDelaySeconds(seconds: number): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_DELAY, String(Math.max(0, Math.round(seconds))));\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n\n/** Screensaver background image URL. Empty string = geen afbeelding. */\nexport function getScreensaverBackgroundImage(): string {\n  if (typeof window === \"undefined\") return \"\";\n  try {\n    const v = localStorage.getItem(STORAGE_KEY_BACKGROUND);\n    return typeof v === \"string\" ? v : \"\";\n  } catch {\n    return \"\";\n  }\n}\n\nexport function setScreensaverBackgroundImage(url: string): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_BACKGROUND, url || \"\");\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n\nconst STORAGE_KEY_CLOCK24 = \"dashboard.screensaverClock24h\";\n\n/** Klok 24-uurs (true) of 12-uurs am/pm (false). Default true. */\nexport function getScreensaverClock24h(): boolean {\n  if (typeof window === \"undefined\") return true;\n  try {\n    const v = localStorage.getItem(STORAGE_KEY_CLOCK24);\n    if (v === \"false\") return false;\n    if (v === \"true\") return true;\n    return true;\n  } catch {\n    return true;\n  }\n}\n\nexport function setScreensaverClock24h(value: boolean): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_CLOCK24, value ? \"true\" : \"false\");\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n\nconst STORAGE_KEY_WEATHER_ENTITY = \"dashboard.screensaverWeatherEntityId\";\n\n/** Weather entity voor screensaver (bijv. weather.home). Leeg = fallback naar header-temperatuurentity. */\nexport function getScreensaverWeatherEntityId(): string | null {\n  if (typeof window === \"undefined\") return null;\n  try {\n    const v = localStorage.getItem(STORAGE_KEY_WEATHER_ENTITY);\n    return v && v.length > 0 ? v : null;\n  } catch {\n    return null;\n  }\n}\n\nexport function setScreensaverWeatherEntityId(entityId: string | null): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_WEATHER_ENTITY, entityId ?? \"\");\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n\nconst STORAGE_KEY_PEXELS_ENABLED = \"dashboard.screensaverPexelsEnabled\";\nconst STORAGE_KEY_PEXELS_QUERY = \"dashboard.screensaverPexelsQuery\";\nconst STORAGE_KEY_PEXELS_API_KEY = \"dashboard.screensaverPexelsApiKey\";\n\n/** Pexels-foto's gebruiken als screensaver-achtergrond (alleen als er geen custom afbeelding is). */\nexport function getScreensaverPexelsEnabled(): boolean {\n  if (typeof window === \"undefined\") return false;\n  try {\n    return localStorage.getItem(STORAGE_KEY_PEXELS_ENABLED) === \"true\";\n  } catch {\n    return false;\n  }\n}\n\nexport function setScreensaverPexelsEnabled(enabled: boolean): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_PEXELS_ENABLED, enabled ? \"true\" : \"false\");\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n\n/** Zoekterm voor Pexels (bijv. \"nature landscape\", \"mountains\"). */\nexport function getScreensaverPexelsQuery(): string {\n  if (typeof window === \"undefined\") return \"nature landscape\";\n  try {\n    const v = localStorage.getItem(STORAGE_KEY_PEXELS_QUERY);\n    return typeof v === \"string\" && v.trim() ? v.trim() : \"nature landscape\";\n  } catch {\n    return \"nature landscape\";\n  }\n}\n\nexport function setScreensaverPexelsQuery(query: string): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_PEXELS_QUERY, query.trim() || \"nature landscape\");\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n\n/** Pexels API-key (gratis op pexels.com/api). Opgeslagen lokaal, niet op de server. */\nexport function getScreensaverPexelsApiKey(): string {\n  if (typeof window === \"undefined\") return \"\";\n  try {\n    const v = localStorage.getItem(STORAGE_KEY_PEXELS_API_KEY);\n    return typeof v === \"string\" ? v : \"\";\n  } catch {\n    return \"\";\n  }\n}\n\nexport function setScreensaverPexelsApiKey(apiKey: string): void {\n  try {\n    localStorage.setItem(STORAGE_KEY_PEXELS_API_KEY, apiKey.trim());\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\n  } catch {\n    // ignore\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/stores/entity-state-store.ts"],"sourcesContent":["import { create } from \"zustand\";\n\nexport type EntityState = {\n  entity_id: string;\n  state: string;\n  attributes: Record<string, unknown>;\n};\n\ntype EntityStateStore = {\n  states: Record<string, EntityState>;\n  updatedAt: number | null;\n  error: string | null;\n  /** Verhoog om directe refresh aan te vragen (bv. bij dashboard met stat pills). */\n  refreshRequested: number;\n  setStates: (entities: EntityState[]) => void;\n  /** Optimistic update voor één entity (bijv. direct aan/uit tonen). */\n  updateEntityState: (entityId: string, patch: Partial<Pick<EntityState, \"state\" | \"attributes\">>) => void;\n  setError: (error: string | null) => void;\n  getState: (entityId: string) => EntityState | undefined;\n  isOffline: () => boolean;\n  /** Vraag directe entity state refresh aan (voor betrouwbare stat pill weergave). */\n  requestRefresh: () => void;\n};\n\nexport const useEntityStateStore = create<EntityStateStore>((set, get) => ({\n  states: {},\n  updatedAt: null,\n  error: null,\n  refreshRequested: 0,\n  setStates: (entities) => {\n    const states: Record<string, EntityState> = {};\n    for (const e of entities) {\n      states[e.entity_id] = e;\n    }\n    set({ states, updatedAt: Date.now(), error: null });\n  },\n  updateEntityState: (entityId, patch) => {\n    const current = get().states[entityId];\n    if (!current) return;\n    set({\n      states: {\n        ...get().states,\n        [entityId]: { ...current, ...patch },\n      },\n      updatedAt: Date.now(),\n    });\n  },\n  setError: (error) => set({ error }),\n  getState: (entityId) => get().states[entityId],\n  isOffline: () => get().error != null,\n  requestRefresh: () => set((s) => ({ refreshRequested: s.refreshRequested + 1 })),\n}));\n"],"names":[],"mappings":";;;;AAAA;;AAwBO,MAAM,sBAAsB,IAAA,qJAAM,EAAmB,CAAC,KAAK,MAAQ,CAAC;QACzE,QAAQ,CAAC;QACT,WAAW;QACX,OAAO;QACP,kBAAkB;QAClB,WAAW,CAAC;YACV,MAAM,SAAsC,CAAC;YAC7C,KAAK,MAAM,KAAK,SAAU;gBACxB,MAAM,CAAC,EAAE,SAAS,CAAC,GAAG;YACxB;YACA,IAAI;gBAAE;gBAAQ,WAAW,KAAK,GAAG;gBAAI,OAAO;YAAK;QACnD;QACA,mBAAmB,CAAC,UAAU;YAC5B,MAAM,UAAU,MAAM,MAAM,CAAC,SAAS;YACtC,IAAI,CAAC,SAAS;YACd,IAAI;gBACF,QAAQ;oBACN,GAAG,MAAM,MAAM;oBACf,CAAC,SAAS,EAAE;wBAAE,GAAG,OAAO;wBAAE,GAAG,KAAK;oBAAC;gBACrC;gBACA,WAAW,KAAK,GAAG;YACrB;QACF;QACA,UAAU,CAAC,QAAU,IAAI;gBAAE;YAAM;QACjC,UAAU,CAAC,WAAa,MAAM,MAAM,CAAC,SAAS;QAC9C,WAAW,IAAM,MAAM,KAAK,IAAI;QAChC,gBAAgB,IAAM,IAAI,CAAC,IAAM,CAAC;oBAAE,kBAAkB,EAAE,gBAAgB,GAAG;gBAAE,CAAC;IAChF,CAAC","debugId":null}},
    {"offset": {"line": 351, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/screensaver.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback } from \"react\";\nimport Image from \"next/image\";\nimport { createPortal } from \"react-dom\";\nimport {\n  Cloud,\n  CloudFog,\n  CloudLightning,\n  CloudRain,\n  CloudSnow,\n  Moon,\n  Sun,\n  Wind,\n} from \"lucide-react\";\nimport { getScreensaverDelaySeconds, getScreensaverBackgroundImage, getScreensaverClock24h, getScreensaverWeatherEntityId, getScreensaverPexelsEnabled, getScreensaverPexelsQuery, getScreensaverPexelsApiKey } from \"@/stores/screensaver-store\";\nimport { useEntityStateStore } from \"@/stores/entity-state-store\";\n\n/** Standaard achtergrond wanneer er geen afbeelding is geüpload (zet bestand in public/default-screensaver.png). */\nconst DEFAULT_SCREENSAVER_IMAGE = \"/default-screensaver.png\";\n\nconst ACTIVITY_EVENTS = [\"mousemove\", \"mousedown\", \"keydown\", \"touchstart\", \"scroll\", \"click\"] as const;\nconst PHOTO_ROTATION_SECONDS = 10;\nconst FADE_DURATION_MS = 1500;\n\nfunction useIdleScreensaver() {\n  const [active, setActive] = useState(false);\n  const [timeoutSeconds, setTimeoutSeconds] = useState(0);\n\n  useEffect(() => {\n    const sec = getScreensaverDelaySeconds();\n    setTimeoutSeconds(sec);\n    const onSettingChange = () => setTimeoutSeconds(getScreensaverDelaySeconds());\n    const onActivate = () => setActive(true);\n    window.addEventListener(\"screensaver-setting-changed\", onSettingChange);\n    window.addEventListener(\"screensaver-activate\", onActivate);\n    return () => {\n      window.removeEventListener(\"screensaver-setting-changed\", onSettingChange);\n      window.removeEventListener(\"screensaver-activate\", onActivate);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (timeoutSeconds <= 0) {\n      setActive(false);\n      return;\n    }\n    const delayMs = timeoutSeconds * 1000;\n    let timeoutId: ReturnType<typeof setTimeout> | null = null;\n\n    const resetTimer = () => {\n      setActive(false);\n      if (timeoutId) clearTimeout(timeoutId);\n      timeoutId = setTimeout(() => setActive(true), delayMs);\n    };\n\n    resetTimer();\n\n    const onActivity = () => resetTimer();\n    for (const ev of ACTIVITY_EVENTS) {\n      window.addEventListener(ev, onActivity, { passive: true });\n    }\n\n    return () => {\n      for (const ev of ACTIVITY_EVENTS) {\n        window.removeEventListener(ev, onActivity);\n      }\n      if (timeoutId) clearTimeout(timeoutId);\n    };\n  }, [timeoutSeconds]);\n\n  return { active, setActive };\n}\n\nfunction ScreensaverWeatherIcon({ state }: { state: string }) {\n  const s = state?.toLowerCase() ?? \"\";\n  const iconClass = \"h-6 w-6 shrink-0 text-white/90\";\n  if (s === \"sunny\" || s === \"clear\") return <Sun className={iconClass} aria-hidden />;\n  if (s === \"clear-night\") return <Moon className={iconClass} aria-hidden />;\n  if (s === \"fog\" || s === \"mist\") return <CloudFog className={iconClass} aria-hidden />;\n  if (s === \"rainy\" || s === \"pouring\" || s === \"hail\") return <CloudRain className={iconClass} aria-hidden />;\n  if (s === \"snowy\" || s === \"snowy-rainy\") return <CloudSnow className={iconClass} aria-hidden />;\n  if (s === \"lightning\" || s === \"lightning-rainy\") return <CloudLightning className={iconClass} aria-hidden />;\n  if (s === \"windy\" || s === \"windy-variant\") return <Wind className={iconClass} aria-hidden />;\n  if (s === \"cloudy\" || s === \"partlycloudy\" || s === \"exceptional\") return <Cloud className={iconClass} aria-hidden />;\n  return <Cloud className={iconClass} aria-hidden />;\n}\n\nfunction ScreensaverWeather() {\n  const entityId =\n    getScreensaverWeatherEntityId() ??\n    (typeof window !== \"undefined\" ? localStorage.getItem(\"dashboard.headerTemperatureEntityId\") : null) ??\n    \"weather.home\";\n  const entity = useEntityStateStore((s) => s.getState(entityId));\n\n  const condition = (entity?.state as string) ?? \"\";\n  const temperature =\n    entity?.attributes?.temperature != null\n      ? Number(entity.attributes.temperature)\n      : (entity?.state != null && entityId.startsWith(\"sensor.\") ? Number(entity.state) : undefined);\n  const tempStr =\n    temperature != null && !Number.isNaN(temperature)\n      ? `${Math.round(temperature)}°`\n      : null;\n\n  if (!tempStr && !condition) return null;\n\n  return (\n    <div className=\"flex items-center gap-2 text-white/90 drop-shadow-md\">\n      {(condition || entityId.startsWith(\"weather.\")) && (\n        <ScreensaverWeatherIcon state={condition} />\n      )}\n      {tempStr && (\n        <span className=\"text-xl font-light tabular-nums\">{tempStr}</span>\n      )}\n    </div>\n  );\n}\n\nfunction ScreensaverClock() {\n  const [time, setTime] = useState(() => new Date());\n  const use24h = getScreensaverClock24h();\n\n  useEffect(() => {\n    const interval = setInterval(() => setTime(new Date()), 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const timeStr = use24h\n    ? `${time.getHours().toString().padStart(2, \"0\")}:${time.getMinutes().toString().padStart(2, \"0\")}`\n    : `${(time.getHours() % 12 || 12)}:${time.getMinutes().toString().padStart(2, \"0\")}`;\n  const ampm = use24h ? null : (time.getHours() < 12 ? \"am\" : \"pm\");\n\n  const dateStr = time.toLocaleDateString(\"nl-NL\", {\n    weekday: \"long\",\n    day: \"numeric\",\n    month: \"long\",\n  });\n\n  return (\n    <div className=\"flex flex-col items-end gap-1\">\n      <time\n        dateTime={time.toISOString()}\n        className=\"text-5xl sm:text-6xl font-light tabular-nums text-white/90 drop-shadow-md\"\n      >\n        {timeStr}\n        {ampm != null && (\n          <span className=\"ml-1.5 text-lg sm:text-xl font-normal text-white/70\">\n            {ampm}\n          </span>\n        )}\n      </time>\n      <span className=\"text-sm text-white/50 tabular-nums\">{dateStr}</span>\n    </div>\n  );\n}\n\nfunction ScreensaverOverlay({ onDismiss }: { onDismiss: () => void }) {\n  const customBg = getScreensaverBackgroundImage();\n  const pexelsEnabled = getScreensaverPexelsEnabled();\n  const pexelsQuery = getScreensaverPexelsQuery();\n  const pexelsApiKey = getScreensaverPexelsApiKey();\n\n  const [currentImage, setCurrentImage] = useState<string | null>(null);\n  const [nextImage, setNextImage] = useState<string | null>(null);\n  const [currentAttribution, setCurrentAttribution] = useState<{ url: string; photographer: string } | null>(null);\n  const [nextAttribution, setNextAttribution] = useState<{ url: string; photographer: string } | null>(null);\n  const [isFading, setIsFading] = useState(false);\n  const [imageFailed, setImageFailed] = useState(false);\n  const [pexelsError, setPexelsError] = useState(false);\n\n  const fetchPexelsPhoto = useCallback(() => {\n    if (!pexelsApiKey) return;\n    setPexelsError(false);\n    fetch(`/api/pexels/photo?query=${encodeURIComponent(pexelsQuery)}`, {\n      headers: { \"X-Pexels-Api-Key\": pexelsApiKey },\n    })\n      .then((r) => r.json())\n      .then((data) => {\n        if (data?.imageUrl) {\n          const attr = data.pexelsUrl && data.photographer ? { url: data.pexelsUrl, photographer: data.photographer } : null;\n          setCurrentImage((prev) => {\n            if (prev) {\n              setNextImage(data.imageUrl);\n              setNextAttribution(attr);\n              return prev;\n            }\n            setCurrentAttribution(attr);\n            return data.imageUrl;\n          });\n        } else {\n          setPexelsError(true);\n        }\n      })\n      .catch(() => setPexelsError(true));\n  }, [pexelsApiKey, pexelsQuery]);\n\n  useEffect(() => {\n    if (customBg || !pexelsEnabled || !pexelsApiKey) return;\n    fetchPexelsPhoto();\n  }, [customBg, pexelsEnabled, pexelsApiKey, pexelsQuery, fetchPexelsPhoto]);\n\n  useEffect(() => {\n    if (customBg || !pexelsEnabled || !pexelsApiKey || !currentImage || nextImage) return;\n    const interval = setInterval(fetchPexelsPhoto, PHOTO_ROTATION_SECONDS * 1000);\n    return () => clearInterval(interval);\n  }, [customBg, pexelsEnabled, pexelsApiKey, currentImage, nextImage, fetchPexelsPhoto]);\n\n  useEffect(() => {\n    if (!nextImage) return;\n    const start = requestAnimationFrame(() => setIsFading(true));\n    return () => cancelAnimationFrame(start);\n  }, [nextImage]);\n\n  useEffect(() => {\n    if (!isFading) return;\n    const timer = setTimeout(() => {\n      setCurrentImage(nextImage);\n      setCurrentAttribution(nextAttribution);\n      setNextImage(null);\n      setNextAttribution(null);\n      setIsFading(false);\n    }, FADE_DURATION_MS);\n    return () => clearTimeout(timer);\n  }, [isFading, nextImage, nextAttribution]);\n\n  const usePexelsRotation = pexelsEnabled && !customBg && pexelsApiKey;\n  const backgroundImage = customBg || currentImage || DEFAULT_SCREENSAVER_IMAGE;\n  const useGradient = imageFailed || (pexelsEnabled && !customBg && (pexelsError && !currentImage || !pexelsApiKey));\n\n  const singleImage = !usePexelsRotation || (!nextImage && !isFading);\n  const fadeStyle = { transition: `opacity ${FADE_DURATION_MS}ms ease-in-out` as const };\n\n  return (\n    <div\n      role=\"button\"\n      tabIndex={0}\n      aria-label=\"Screensaver aanraken om te sluiten\"\n      className=\"fixed inset-0 z-[9999] flex items-end justify-end p-8 cursor-pointer focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50\"\n      style={\n        useGradient\n          ? { background: \"linear-gradient(to bottom right, #111827, #1f2937, #000)\" }\n          : undefined\n      }\n      onClick={onDismiss}\n      onKeyDown={(e) => {\n        if (e.key === \"Enter\" || e.key === \" \") onDismiss();\n      }}\n    >\n      {!useGradient && (\n        <>\n          {singleImage ? (\n            <>\n              <div\n                className=\"absolute inset-0 bg-cover bg-center bg-no-repeat\"\n                style={{ backgroundImage: `url(${backgroundImage})` }}\n                aria-hidden\n              />\n              <div className=\"absolute inset-0 pointer-events-none\" aria-hidden>\n                <Image\n                  src={backgroundImage}\n                  alt=\"\"\n                  fill\n                  sizes=\"100vw\"\n                  className=\"sr-only\"\n                  onError={() => setImageFailed(true)}\n                  unoptimized\n                />\n              </div>\n            </>\n          ) : (\n            <>\n              <div\n                className=\"absolute inset-0 bg-cover bg-center bg-no-repeat\"\n                style={{\n                  ...fadeStyle,\n                  backgroundImage: `url(${currentImage})`,\n                  opacity: isFading ? 0 : 1,\n                }}\n                aria-hidden\n              />\n              {nextImage && (\n                <div\n                  className=\"absolute inset-0 bg-cover bg-center bg-no-repeat\"\n                  style={{\n                    ...fadeStyle,\n                    backgroundImage: `url(${nextImage})`,\n                    opacity: isFading ? 1 : 0,\n                  }}\n                  aria-hidden\n                />\n              )}\n            </>\n          )}\n          <div className=\"absolute inset-0 bg-black/50\" aria-hidden />\n        </>\n      )}\n      <div className=\"relative z-10 flex flex-col items-end gap-4\">\n        <ScreensaverWeather />\n        <ScreensaverClock />\n        {currentAttribution && (\n          <a\n            href={currentAttribution.url}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"text-xs text-white/50 hover:text-white/70 transition-colors\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            Photo by {currentAttribution.photographer} on Pexels\n          </a>\n        )}\n        {pexelsEnabled && !currentAttribution && !pexelsError && (\n          <a\n            href=\"https://www.pexels.com\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"text-xs text-white/50 hover:text-white/70 transition-colors\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            Photos provided by Pexels\n          </a>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function ScreensaverProvider({ children }: { children: React.ReactNode }) {\n  const { active, setActive } = useIdleScreensaver();\n\n  const dismiss = useCallback(() => setActive(false), [setActive]);\n\n  return (\n    <>\n      {children}\n      {active &&\n        typeof document !== \"undefined\" &&\n        createPortal(\n          <ScreensaverOverlay onDismiss={dismiss} />,\n          document.body\n        )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 952, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/hooks/use-entity-state.ts"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport { useEntityStateStore } from \"@/stores/entity-state-store\";\n\nconst POLL_INTERVAL_MS = 5000;\n\n/**\n * Poll GET /api/ha/state and update entity state store.\n * Call once from a provider or dashboard layout so widgets can read live state.\n * Reageert op requestRefresh() voor directe refresh bij bijv. stat pill dashboards.\n */\nexport function useEntityStatePolling(connectionId?: string) {\n  const setStates = useEntityStateStore((s) => s.setStates);\n  const setError = useEntityStateStore((s) => s.setError);\n  const refreshRequested = useEntityStateStore((s) => s.refreshRequested);\n  const intervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  useEffect(() => {\n    const url = connectionId\n      ? `/api/ha/state?connectionId=${encodeURIComponent(connectionId)}`\n      : \"/api/ha/state\";\n\n    function poll() {\n      fetch(url)\n        .then((res) => {\n          if (!res.ok) throw new Error(\"Fetch failed\");\n          return res.json();\n        })\n        .then((data) => {\n          if (Array.isArray(data)) setStates(data);\n        })\n        .catch(() => setError(\"No connection\"));\n    }\n\n    poll();\n    intervalRef.current = setInterval(poll, POLL_INTERVAL_MS);\n    return () => {\n      if (intervalRef.current) clearInterval(intervalRef.current);\n    };\n  }, [connectionId, setStates, setError]);\n\n  useEffect(() => {\n    if (refreshRequested > 0) {\n      const url = connectionId\n        ? `/api/ha/state?connectionId=${encodeURIComponent(connectionId)}`\n        : \"/api/ha/state\";\n      fetch(url)\n        .then((res) => {\n          if (!res.ok) throw new Error(\"Fetch failed\");\n          return res.json();\n        })\n        .then((data) => {\n          if (Array.isArray(data)) setStates(data);\n        })\n        .catch(() => setError(\"No connection\"));\n    }\n  }, [refreshRequested, connectionId, setStates, setError]);\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKA,MAAM,mBAAmB;AAOlB,SAAS,sBAAsB,YAAqB;;IACzD,MAAM,YAAY,IAAA,mKAAmB;gEAAC,CAAC,IAAM,EAAE,SAAS;;IACxD,MAAM,WAAW,IAAA,mKAAmB;+DAAC,CAAC,IAAM,EAAE,QAAQ;;IACtD,MAAM,mBAAmB,IAAA,mKAAmB;uEAAC,CAAC,IAAM,EAAE,gBAAgB;;IACtE,MAAM,cAAc,IAAA,uKAAM,EAAwC;IAElE,IAAA,0KAAS;2CAAC;YACR,MAAM,MAAM,eACR,AAAC,8BAA8D,OAAjC,mBAAmB,iBACjD;YAEJ,SAAS;gBACP,MAAM,KACH,IAAI;4DAAC,CAAC;wBACL,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;wBAC7B,OAAO,IAAI,IAAI;oBACjB;2DACC,IAAI;4DAAC,CAAC;wBACL,IAAI,MAAM,OAAO,CAAC,OAAO,UAAU;oBACrC;2DACC,KAAK;4DAAC,IAAM,SAAS;;YAC1B;YAEA;YACA,YAAY,OAAO,GAAG,YAAY,MAAM;YACxC;mDAAO;oBACL,IAAI,YAAY,OAAO,EAAE,cAAc,YAAY,OAAO;gBAC5D;;QACF;0CAAG;QAAC;QAAc;QAAW;KAAS;IAEtC,IAAA,0KAAS;2CAAC;YACR,IAAI,mBAAmB,GAAG;gBACxB,MAAM,MAAM,eACR,AAAC,8BAA8D,OAAjC,mBAAmB,iBACjD;gBACJ,MAAM,KACH,IAAI;uDAAC,CAAC;wBACL,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;wBAC7B,OAAO,IAAI,IAAI;oBACjB;sDACC,IAAI;uDAAC,CAAC;wBACL,IAAI,MAAM,OAAO,CAAC,OAAO,UAAU;oBACrC;sDACC,KAAK;uDAAC,IAAM,SAAS;;YAC1B;QACF;0CAAG;QAAC;QAAkB;QAAc;QAAW;KAAS;AAC1D;GA9CgB;;QACI,mKAAmB;QACpB,mKAAmB;QACX,mKAAmB","debugId":null}},
    {"offset": {"line": 1044, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/providers.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\r\nimport { useState } from \"react\";\r\nimport { ThemeProvider } from \"./theme-provider\";\r\nimport { ScreensaverProvider } from \"./screensaver\";\r\nimport { useEntityStatePolling } from \"@/hooks/use-entity-state\";\r\n\r\nexport function Providers({ children }: { children: React.ReactNode }) {\r\n  const [queryClient] = useState(\r\n    () =>\r\n      new QueryClient({\r\n        defaultOptions: {\r\n          queries: { staleTime: 60 * 1000 },\r\n        },\r\n      })\r\n  );\r\n\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      <ThemeProvider>\r\n        <EntityStatePoller />\r\n        <ScreensaverProvider>{children}</ScreensaverProvider>\r\n      </ThemeProvider>\r\n    </QueryClientProvider>\r\n  );\r\n}\r\n\r\nfunction EntityStatePoller() {\r\n  useEntityStatePolling();\r\n  return null;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAQO,SAAS,UAAU,KAA2C;QAA3C,EAAE,QAAQ,EAAiC,GAA3C;;IACxB,MAAM,CAAC,YAAY,GAAG,IAAA,yKAAQ;8BAC5B,IACE,IAAI,+LAAW,CAAC;gBACd,gBAAgB;oBACd,SAAS;wBAAE,WAAW,KAAK;oBAAK;gBAClC;YACF;;IAGJ,qBACE,6LAAC,gNAAmB;QAAC,QAAQ;kBAC3B,cAAA,6LAAC,2JAAa;;8BACZ,6LAAC;;;;;8BACD,6LAAC,2JAAmB;8BAAE;;;;;;;;;;;;;;;;;AAI9B;GAlBgB;KAAA;AAoBhB,SAAS;;IACP,IAAA,kKAAqB;IACrB,OAAO;AACT;IAHS;;QACP,kKAAqB;;;MADd","debugId":null}},
    {"offset": {"line": 1126, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/lib/onboarding-completed.ts"],"sourcesContent":["const KEY = \"onboarding_completed\";\r\n\r\nexport function setOnboardingCompleted(): void {\r\n  if (typeof window === \"undefined\") return;\r\n  window.localStorage.setItem(KEY, \"true\");\r\n}\r\n\r\nexport function getOnboardingCompleted(): boolean {\r\n  if (typeof window === \"undefined\") return false;\r\n  return window.localStorage.getItem(KEY) === \"true\";\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,MAAM;AAEL,SAAS;IACd;;IACA,OAAO,YAAY,CAAC,OAAO,CAAC,KAAK;AACnC;AAEO,SAAS;IACd;;IACA,OAAO,OAAO,YAAY,CAAC,OAAO,CAAC,SAAS;AAC9C","debugId":null}},
    {"offset": {"line": 1150, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/onboarding-guard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getOnboardingCompleted, setOnboardingCompleted } from \"@/lib/onboarding-completed\";\r\n\r\nexport function OnboardingGuard({ children }: { children: React.ReactNode }) {\r\n  const pathname = usePathname();\r\n  const router = useRouter();\r\n  const [allowed, setAllowed] = useState<boolean | null>(null);\r\n\r\n  useEffect(() => {\r\n    const completed = getOnboardingCompleted();\r\n    const isOnboardingStart = pathname === \"/onboarding/start\";\r\n    const isOnboardingWizard = pathname === \"/onboarding\";\r\n\r\n    if (completed || isOnboardingStart || isOnboardingWizard) {\r\n      setAllowed(true);\r\n      return;\r\n    }\r\n\r\n    // Geen onboarding-flag in localStorage: check of er al een dashboard is (bijv. eerste start na deploy met bestaande data)\r\n    fetch(\"/api/dashboard\")\r\n      .then((r) => r.json())\r\n      .then((d) => {\r\n        if (d?.id) {\r\n          setOnboardingCompleted();\r\n          setAllowed(true);\r\n          if (pathname === \"/\" || pathname === \"/dashboards\") {\r\n            router.replace(`/dashboards/${d.id}`);\r\n          }\r\n        } else {\r\n          router.replace(\"/onboarding/start\");\r\n          setAllowed(false);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        router.replace(\"/onboarding/start\");\r\n        setAllowed(false);\r\n      });\r\n  }, [pathname, router]);\r\n\r\n  if (allowed === null || !allowed) {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center bg-page-light dark:bg-dark-page\">\r\n        <div className=\"h-8 w-8 animate-spin rounded-full border-2 border-accent-yellow dark:border-accent-green border-t-transparent\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMO,SAAS,gBAAgB,KAA2C;QAA3C,EAAE,QAAQ,EAAiC,GAA3C;;IAC9B,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAiB;IAEvD,IAAA,0KAAS;qCAAC;YACR,MAAM,YAAY,IAAA,kKAAsB;YACxC,MAAM,oBAAoB,aAAa;YACvC,MAAM,qBAAqB,aAAa;YAExC,IAAI,aAAa,qBAAqB,oBAAoB;gBACxD,WAAW;gBACX;YACF;YAEA,0HAA0H;YAC1H,MAAM,kBACH,IAAI;6CAAC,CAAC,IAAM,EAAE,IAAI;4CAClB,IAAI;6CAAC,CAAC;oBACL,IAAI,cAAA,wBAAA,EAAG,EAAE,EAAE;wBACT,IAAA,kKAAsB;wBACtB,WAAW;wBACX,IAAI,aAAa,OAAO,aAAa,eAAe;4BAClD,OAAO,OAAO,CAAC,AAAC,eAAmB,OAAL,EAAE,EAAE;wBACpC;oBACF,OAAO;wBACL,OAAO,OAAO,CAAC;wBACf,WAAW;oBACb;gBACF;4CACC,KAAK;6CAAC;oBACL,OAAO,OAAO,CAAC;oBACf,WAAW;gBACb;;QACJ;oCAAG;QAAC;QAAU;KAAO;IAErB,IAAI,YAAY,QAAQ,CAAC,SAAS;QAChC,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,qBAAO;kBAAG;;AACZ;GA7CgB;;QACG,oJAAW;QACb,kJAAS;;;KAFV","debugId":null}},
    {"offset": {"line": 1242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/page-background.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { useThemeStore } from \"@/stores/theme-store\";\r\n\r\ntype BackgroundData = {\r\n  background: string | null;\r\n  backgroundLight: string | null;\r\n  backgroundDark: string | null;\r\n};\r\n\r\nfunction fetchBackground(): Promise<BackgroundData> {\r\n  return fetch(\"/api/dashboard\")\r\n    .then((r) => r.json())\r\n    .then((d) => ({\r\n      background: d?.background ?? null,\r\n      backgroundLight: d?.backgroundLight ?? null,\r\n      backgroundDark: d?.backgroundDark ?? null,\r\n    }))\r\n    .catch(() => ({ background: null, backgroundLight: null, backgroundDark: null }));\r\n}\r\n\r\nconst PageBackgroundContext = createContext<string | null>(null);\r\n\r\nexport function usePageBackground() {\r\n  return useContext(PageBackgroundContext);\r\n}\r\n\r\nexport function PageBackgroundProvider({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  const [data, setData] = useState<BackgroundData>({\r\n    background: null,\r\n    backgroundLight: null,\r\n    backgroundDark: null,\r\n  });\r\n  const resolved = useThemeStore((s) => s.resolved);\r\n\r\n  useEffect(() => {\r\n    fetchBackground().then(setData);\r\n    const onUpdate = () => fetchBackground().then(setData);\r\n    window.addEventListener(\"page-background-changed\", onUpdate);\r\n    return () => window.removeEventListener(\"page-background-changed\", onUpdate);\r\n  }, []);\r\n\r\n  const url =\r\n    (resolved === \"dark\" ? data.backgroundDark : data.backgroundLight) ??\r\n    data.background ??\r\n    null;\r\n\r\n  return (\r\n    <PageBackgroundContext.Provider value={url}>\r\n      {url ? (\r\n        <div\r\n          className=\"fixed inset-0 -z-10 bg-cover bg-center bg-no-repeat\"\r\n          style={{ backgroundImage: `url(${url})` }}\r\n          aria-hidden\r\n        />\r\n      ) : null}\r\n      {children}\r\n    </PageBackgroundContext.Provider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;AAHA;;;AAWA,SAAS;IACP,OAAO,MAAM,kBACV,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,IAClB,IAAI,CAAC,CAAC;YACO,eACK,oBACD;eAHJ;YACZ,YAAY,CAAA,gBAAA,cAAA,wBAAA,EAAG,UAAU,cAAb,2BAAA,gBAAiB;YAC7B,iBAAiB,CAAA,qBAAA,cAAA,wBAAA,EAAG,eAAe,cAAlB,gCAAA,qBAAsB;YACvC,gBAAgB,CAAA,oBAAA,cAAA,wBAAA,EAAG,cAAc,cAAjB,+BAAA,oBAAqB;QACvC;OACC,KAAK,CAAC,IAAM,CAAC;YAAE,YAAY;YAAM,iBAAiB;YAAM,gBAAgB;QAAK,CAAC;AACnF;AAEA,MAAM,sCAAwB,IAAA,8KAAa,EAAgB;AAEpD,SAAS;;IACd,OAAO,IAAA,2KAAU,EAAC;AACpB;GAFgB;AAIT,SAAS,uBAAuB,KAItC;QAJsC,EACrC,QAAQ,EAGT,GAJsC;;IAKrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAiB;QAC/C,YAAY;QACZ,iBAAiB;QACjB,gBAAgB;IAClB;IACA,MAAM,WAAW,IAAA,mJAAa;0DAAC,CAAC,IAAM,EAAE,QAAQ;;IAEhD,IAAA,0KAAS;4CAAC;YACR,kBAAkB,IAAI,CAAC;YACvB,MAAM;6DAAW,IAAM,kBAAkB,IAAI,CAAC;;YAC9C,OAAO,gBAAgB,CAAC,2BAA2B;YACnD;oDAAO,IAAM,OAAO,mBAAmB,CAAC,2BAA2B;;QACrE;2CAAG,EAAE;QAGH,MAAA;IADF,MAAM,MACJ,CAAA,QAAA,CAAA,OAAC,aAAa,SAAS,KAAK,cAAc,GAAG,KAAK,eAAe,cAAjE,kBAAA,OACA,KAAK,UAAU,cADf,mBAAA,QAEA;IAEF,qBACE,6LAAC,sBAAsB,QAAQ;QAAC,OAAO;;YACpC,oBACC,6LAAC;gBACC,WAAU;gBACV,OAAO;oBAAE,iBAAiB,AAAC,OAAU,OAAJ,KAAI;gBAAG;gBACxC,aAAW;;;;;uBAEX;YACH;;;;;;;AAGP;IApCgB;;QAUG,mJAAa;;;KAVhB","debugId":null}}]
}