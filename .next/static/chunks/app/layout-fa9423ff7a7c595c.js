(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{13313:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,34097,23)),Promise.resolve().then(n.t.bind(n,13673,23)),Promise.resolve().then(n.bind(n,13562)),Promise.resolve().then(n.bind(n,54813)),Promise.resolve().then(n.bind(n,22175))},13562:(e,t,n)=>{"use strict";n.d(t,{OnboardingGuard:()=>o});var r=n(95155),a=n(20063),s=n(12115),l=n(86861);function o(e){let{children:t}=e,n=(0,a.usePathname)(),o=(0,a.useRouter)(),[i,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=(0,l.j)(),t="/onboarding/start"===n,r="/onboarding"===n;if(e||t||r)return void c(!0);fetch("/api/dashboard").then(e=>e.json()).then(e=>{(null==e?void 0:e.id)?((0,l.L)(),c(!0),("/"===n||"/dashboards"===n)&&o.replace("/dashboards/".concat(e.id))):(o.replace("/onboarding/start"),c(!1))}).catch(()=>{o.replace("/onboarding/start"),c(!1)})},[n,o]),null!==i&&i)?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-page-light dark:bg-dark-page",children:(0,r.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-accent-yellow dark:border-accent-green border-t-transparent"})})}},13673:()=>{},22175:(e,t,n)=>{"use strict";n.d(t,{Providers:()=>I});var r=n(95155),a=n(74852),s=n(99776),l=n(12115),o=n(38876);function i(e){let{children:t}=e,{mode:n,resolved:a,setResolved:s}=(0,o.C)(),i=(0,l.useCallback)(()=>{let e=document.documentElement,t=a;t="auto"===n?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n,e.classList.remove("light","dark"),e.classList.add(t),s(t)},[n,a,s]);return(0,l.useEffect)(()=>{i()},[i]),(0,l.useEffect)(()=>{if("auto"!==n)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>i();return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[n,i]),(0,r.jsx)("div",{className:"min-h-screen transition-theme duration-theme","data-theme":a,children:t})}var c=n(47650),u=n(59427),d=n(37494),h=n(70833),g=n(35733),m=n(61056),f=n(30771),v=n(34157),b=n(32320),p=n(77184),x=n(93420);let w=["mousemove","mousedown","keydown","touchstart","scroll","click"];function k(e){var t;let{state:n}=e,a=null!=(t=null==n?void 0:n.toLowerCase())?t:"",s="h-6 w-6 shrink-0 text-white/90";return"sunny"===a||"clear"===a?(0,r.jsx)(u.A,{className:s,"aria-hidden":!0}):"clear-night"===a?(0,r.jsx)(d.A,{className:s,"aria-hidden":!0}):"fog"===a||"mist"===a?(0,r.jsx)(h.A,{className:s,"aria-hidden":!0}):"rainy"===a||"pouring"===a||"hail"===a?(0,r.jsx)(g.A,{className:s,"aria-hidden":!0}):"snowy"===a||"snowy-rainy"===a?(0,r.jsx)(m.A,{className:s,"aria-hidden":!0}):"lightning"===a||"lightning-rainy"===a?(0,r.jsx)(f.A,{className:s,"aria-hidden":!0}):"windy"===a||"windy-variant"===a?(0,r.jsx)(v.A,{className:s,"aria-hidden":!0}):("cloudy"===a,(0,r.jsx)(b.A,{className:s,"aria-hidden":!0}))}function y(){var e,t,n,a;let s=null!=(n=null!=(t=(0,p.kS)())?t:localStorage.getItem("dashboard.headerTemperatureEntityId"))?n:"weather.home",l=(0,x.j)(e=>e.getState(s)),o=null!=(a=null==l?void 0:l.state)?a:"",i=(null==l||null==(e=l.attributes)?void 0:e.temperature)!=null?Number(l.attributes.temperature):(null==l?void 0:l.state)!=null&&s.startsWith("sensor.")?Number(l.state):void 0,c=null==i||Number.isNaN(i)?null:"".concat(Math.round(i),"\xb0");return c||o?(0,r.jsxs)("div",{className:"flex items-center gap-2 text-white/90 drop-shadow-md",children:[(o||s.startsWith("weather."))&&(0,r.jsx)(k,{state:o}),c&&(0,r.jsx)("span",{className:"text-xl font-light tabular-nums",children:c})]}):null}function j(){let[e,t]=(0,l.useState)(()=>new Date),n=(0,p._0)();(0,l.useEffect)(()=>{let e=setInterval(()=>t(new Date),1e3);return()=>clearInterval(e)},[]);let a=n?"".concat(e.getHours().toString().padStart(2,"0"),":").concat(e.getMinutes().toString().padStart(2,"0")):"".concat(e.getHours()%12||12,":").concat(e.getMinutes().toString().padStart(2,"0")),s=n?null:12>e.getHours()?"am":"pm",o=e.toLocaleDateString("nl-NL",{weekday:"long",day:"numeric",month:"long"});return(0,r.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,r.jsxs)("time",{dateTime:e.toISOString(),className:"text-5xl sm:text-6xl font-light tabular-nums text-white/90 drop-shadow-md",children:[a,null!=s&&(0,r.jsx)("span",{className:"ml-1.5 text-lg sm:text-xl font-normal text-white/70",children:s})]}),(0,r.jsx)("span",{className:"text-sm text-white/50 tabular-nums",children:o})]})}function S(e){let{onDismiss:t}=e,n=(0,p.Bo)(),a=(0,p.iv)(),s=(0,p.lR)(),o=(0,p.YI)(),[i,c]=(0,l.useState)(null),[u,d]=(0,l.useState)(null),[h,g]=(0,l.useState)(null),[m,f]=(0,l.useState)(null),[v,b]=(0,l.useState)(!1),[x,w]=(0,l.useState)(!1),[k,S]=(0,l.useState)(!1),E=(0,l.useCallback)(()=>{o&&(S(!1),fetch("/api/pexels/photo?query=".concat(encodeURIComponent(s)),{headers:{"X-Pexels-Api-Key":o}}).then(e=>e.json()).then(e=>{if(null==e?void 0:e.imageUrl){let t=e.pexelsUrl&&e.photographer?{url:e.pexelsUrl,photographer:e.photographer}:null;c(n=>n?(d(e.imageUrl),f(t),n):(g(t),e.imageUrl))}else S(!0)}).catch(()=>S(!0)))},[o,s]);(0,l.useEffect)(()=>{!n&&a&&o&&E()},[n,a,o,s,E]),(0,l.useEffect)(()=>{if(n||!a||!o||!i||u)return;let e=setInterval(E,1e4);return()=>clearInterval(e)},[n,a,o,i,u,E]),(0,l.useEffect)(()=>{if(!u)return;let e=requestAnimationFrame(()=>b(!0));return()=>cancelAnimationFrame(e)},[u]),(0,l.useEffect)(()=>{if(!v)return;let e=setTimeout(()=>{c(u),g(m),d(null),f(null),b(!1)},1500);return()=>clearTimeout(e)},[v,u,m]);let I=a&&!n&&o,N=n||i||"/default-screensaver.png",C=x||a&&!n&&(k&&!i||!o),L=!I||!u&&!v,P={transition:"opacity ".concat(1500,"ms ease-in-out")};return(0,r.jsxs)("div",{role:"button",tabIndex:0,"aria-label":"Screensaver aanraken om te sluiten",className:"fixed inset-0 z-[9999] flex items-end justify-end p-8 cursor-pointer focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50",style:C?{background:"linear-gradient(to bottom right, #111827, #1f2937, #000)"}:void 0,onClick:t,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&t()},children:[!C&&(0,r.jsxs)(r.Fragment,{children:[L?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(".concat(N,")")},"aria-hidden":!0}),(0,r.jsx)("img",{src:N,alt:"",className:"sr-only",onError:()=>w(!0)})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{...P,backgroundImage:"url(".concat(i,")"),opacity:+!v},"aria-hidden":!0}),u&&(0,r.jsx)("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{...P,backgroundImage:"url(".concat(u,")"),opacity:+!!v},"aria-hidden":!0})]}),(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50","aria-hidden":!0})]}),(0,r.jsxs)("div",{className:"relative z-10 flex flex-col items-end gap-4",children:[(0,r.jsx)(y,{}),(0,r.jsx)(j,{}),h&&(0,r.jsxs)("a",{href:h.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-white/50 hover:text-white/70 transition-colors",onClick:e=>e.stopPropagation(),children:["Photo by ",h.photographer," on Pexels"]}),a&&!h&&!k&&(0,r.jsx)("a",{href:"https://www.pexels.com",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-white/50 hover:text-white/70 transition-colors",onClick:e=>e.stopPropagation(),children:"Photos provided by Pexels"})]})]})}function E(e){let{children:t}=e,{active:n,setActive:a}=function(){let[e,t]=(0,l.useState)(!1),[n,r]=(0,l.useState)(0);return(0,l.useEffect)(()=>{r((0,p.wh)());let e=()=>r((0,p.wh)()),n=()=>t(!0);return window.addEventListener("screensaver-setting-changed",e),window.addEventListener("screensaver-activate",n),()=>{window.removeEventListener("screensaver-setting-changed",e),window.removeEventListener("screensaver-activate",n)}},[]),(0,l.useEffect)(()=>{if(n<=0)return void t(!1);let e=1e3*n,r=null,a=()=>{t(!1),r&&clearTimeout(r),r=setTimeout(()=>t(!0),e)};a();let s=()=>a();for(let e of w)window.addEventListener(e,s,{passive:!0});return()=>{for(let e of w)window.removeEventListener(e,s);r&&clearTimeout(r)}},[n]),{active:e,setActive:t}}(),s=(0,l.useCallback)(()=>a(!1),[]);return(0,r.jsxs)(r.Fragment,{children:[t,n&&"undefined"!=typeof document&&(0,c.createPortal)((0,r.jsx)(S,{onDismiss:s}),document.body)]})}function I(e){let{children:t}=e,[n]=(0,l.useState)(()=>new a.E({defaultOptions:{queries:{staleTime:6e4}}}));return(0,r.jsx)(s.Ht,{client:n,children:(0,r.jsxs)(i,{children:[(0,r.jsx)(N,{}),(0,r.jsx)(E,{children:t})]})})}function N(){return!function(e){let t=(0,x.j)(e=>e.setStates),n=(0,x.j)(e=>e.setError),r=(0,x.j)(e=>e.refreshRequested),a=(0,l.useRef)(null);(0,l.useEffect)(()=>{function e(){fetch("/api/ha/state").then(e=>{if(!e.ok)throw Error("Fetch failed");return e.json()}).then(e=>{Array.isArray(e)&&t(e)}).catch(()=>n("No connection"))}return e(),a.current=setInterval(e,5e3),()=>{a.current&&clearInterval(a.current)}},[void 0,t,n]),(0,l.useEffect)(()=>{r>0&&fetch(e?"/api/ha/state?connectionId=".concat(encodeURIComponent(e)):"/api/ha/state").then(e=>{if(!e.ok)throw Error("Fetch failed");return e.json()}).then(e=>{Array.isArray(e)&&t(e)}).catch(()=>n("No connection"))},[r,e,t,n])}(),null}},38876:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var r=n(25959),a=n(89863);let s=(0,r.v)()((0,a.Zr)(e=>({mode:"auto",resolved:"light",setMode:t=>e({mode:t}),setResolved:t=>e({resolved:t})}),{name:"dashboard-theme"}))},54813:(e,t,n)=>{"use strict";n.d(t,{D:()=>i,PageBackgroundProvider:()=>c});var r=n(95155),a=n(12115),s=n(38876);function l(){return fetch("/api/dashboard").then(e=>e.json()).then(e=>{var t,n,r;return{background:null!=(t=null==e?void 0:e.background)?t:null,backgroundLight:null!=(n=null==e?void 0:e.backgroundLight)?n:null,backgroundDark:null!=(r=null==e?void 0:e.backgroundDark)?r:null}}).catch(()=>({background:null,backgroundLight:null,backgroundDark:null}))}let o=(0,a.createContext)(null);function i(){return(0,a.useContext)(o)}function c(e){var t,n;let{children:i}=e,[c,u]=(0,a.useState)({background:null,backgroundLight:null,backgroundDark:null}),d=(0,s.C)(e=>e.resolved);(0,a.useEffect)(()=>{l().then(u);let e=()=>l().then(u);return window.addEventListener("page-background-changed",e),()=>window.removeEventListener("page-background-changed",e)},[]);let h=null!=(n=null!=(t="dark"===d?c.backgroundDark:c.backgroundLight)?t:c.background)?n:null;return(0,r.jsxs)(o.Provider,{value:h,children:[h?(0,r.jsx)("div",{className:"fixed inset-0 -z-10 bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url(".concat(h,")")},"aria-hidden":!0}):null,i]})}},77184:(e,t,n)=>{"use strict";n.d(t,{Bo:()=>i,MZ:()=>h,RW:()=>c,VB:()=>y,YI:()=>j,_0:()=>d,al:()=>w,iv:()=>x,k6:()=>f,kS:()=>m,lR:()=>k,qZ:()=>S,u0:()=>o,wh:()=>l});let r="dashboard.screensaverDelaySeconds",a="dashboard.screensaverMinutes",s="dashboard.screensaverBackground";function l(){try{let e=localStorage.getItem(r);if(null===e){let e=localStorage.getItem(a);if(null!==e){let t=parseInt(e,10);if(Number.isFinite(t)&&t>=0){let e=60*t;return localStorage.setItem(r,String(e)),localStorage.removeItem(a),e}}return 0}let t=parseInt(e,10);return Number.isFinite(t)&&t>=0?t:0}catch(e){return 0}}function o(e){try{localStorage.setItem(r,String(Math.max(0,Math.round(e)))),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}function i(){try{let e=localStorage.getItem(s);return"string"==typeof e?e:""}catch(e){return""}}function c(e){try{localStorage.setItem(s,e||""),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}let u="dashboard.screensaverClock24h";function d(){try{let e=localStorage.getItem(u);if("false"===e)return!1;return!0}catch(e){return!0}}function h(e){try{localStorage.setItem(u,e?"true":"false"),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}let g="dashboard.screensaverWeatherEntityId";function m(){try{let e=localStorage.getItem(g);return e&&e.length>0?e:null}catch(e){return null}}function f(e){try{localStorage.setItem(g,null!=e?e:""),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}let v="dashboard.screensaverPexelsEnabled",b="dashboard.screensaverPexelsQuery",p="dashboard.screensaverPexelsApiKey";function x(){try{return"true"===localStorage.getItem(v)}catch(e){return!1}}function w(e){try{localStorage.setItem(v,e?"true":"false"),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}function k(){try{let e=localStorage.getItem(b);return"string"==typeof e&&e.trim()?e.trim():"nature landscape"}catch(e){return"nature landscape"}}function y(e){try{localStorage.setItem(b,e.trim()||"nature landscape"),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}function j(){try{let e=localStorage.getItem(p);return"string"==typeof e?e:""}catch(e){return""}}function S(e){try{localStorage.setItem(p,e.trim()),window.dispatchEvent(new CustomEvent("screensaver-setting-changed"))}catch(e){}}},86861:(e,t,n)=>{"use strict";n.d(t,{L:()=>a,j:()=>s});let r="onboarding_completed";function a(){window.localStorage.setItem(r,"true")}function s(){return"true"===window.localStorage.getItem(r)}},93420:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});let r=(0,n(25959).v)((e,t)=>({states:{},updatedAt:null,error:null,refreshRequested:0,setStates:t=>{let n={};for(let e of t)n[e.entity_id]=e;e({states:n,updatedAt:Date.now(),error:null})},updateEntityState:(n,r)=>{let a=t().states[n];a&&e({states:{...t().states,[n]:{...a,...r}},updatedAt:Date.now()})},setError:t=>e({error:t}),getState:e=>t().states[e],isOffline:()=>null!=t().error,requestRefresh:()=>e(e=>({refreshRequested:e.refreshRequested+1}))}))}},e=>{e.O(0,[7898,1315,1328,9963,8441,1255,7358],()=>e(e.s=13313)),_N_E=e.O()}]);