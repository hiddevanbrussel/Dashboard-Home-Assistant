{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/app/api/pexels/photo/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n\r\n/** Haalt een willekeurige foto op van Pexels voor de screensaver. */\r\nexport async function GET(request: NextRequest) {\r\n  const headerKey = request.headers.get(\"x-pexels-api-key\")?.trim();\r\n  const envKey = process.env.PEXELS_API_KEY?.trim();\r\n  const apiKey = headerKey || envKey;\r\n  if (!apiKey) {\r\n    return NextResponse.json(\r\n      { error: \"Geen Pexels API-key. Vul de API-key in bij Instellingen → Screensaver → Pexels, of voeg PEXELS_API_KEY toe aan .env\" },\r\n      { status: 503 }\r\n    );\r\n  }\r\n\r\n  const { searchParams } = new URL(request.url);\r\n  const query = searchParams.get(\"query\")?.trim() || \"nature landscape\";\r\n  const useSearch = query.length > 0;\r\n\r\n  const url = useSearch\r\n    ? `https://api.pexels.com/v1/search?query=${encodeURIComponent(query)}&per_page=20&orientation=landscape`\r\n    : `https://api.pexels.com/v1/curated?per_page=20`;\r\n\r\n  try {\r\n    const res = await fetch(url, {\r\n      headers: { Authorization: apiKey },\r\n      cache: \"no-store\",\r\n    });\r\n\r\n    if (!res.ok) {\r\n      const text = await res.text();\r\n      return NextResponse.json(\r\n        { error: `Pexels API error: ${res.status}`, details: text },\r\n        { status: 502 }\r\n      );\r\n    }\r\n\r\n    const data = (await res.json()) as {\r\n      photos?: { src?: { large2x?: string; original?: string }; url: string; photographer: string }[];\r\n    };\r\n\r\n    const photos = data.photos ?? [];\r\n    if (photos.length === 0) {\r\n      return NextResponse.json(\r\n        { error: \"Geen foto's gevonden\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Willekeurige foto kiezen voor variatie\r\n    const photo = photos[Math.floor(Math.random() * photos.length)];\r\n    const imageUrl = photo.src?.large2x ?? photo.src?.original ?? null;\r\n    const pexelsUrl = photo.url;\r\n    const photographer = photo.photographer;\r\n\r\n    if (!imageUrl) {\r\n      return NextResponse.json({ error: \"Geen afbeeldings-URL\" }, { status: 502 });\r\n    }\r\n\r\n    return NextResponse.json({ imageUrl, pexelsUrl, photographer });\r\n  } catch (err) {\r\n    console.error(\"[Pexels API]\", err);\r\n    return NextResponse.json(\r\n      { error: \"Kon geen foto ophalen van Pexels\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAGO,eAAe,IAAI,OAAoB;IAC5C,MAAM,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC,qBAAqB;IAC3D,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc,EAAE;IAC3C,MAAM,SAAS,aAAa;IAC5B,IAAI,CAAC,QAAQ;QACX,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAsH,GAC/H;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,QAAQ,aAAa,GAAG,CAAC,UAAU,UAAU;IACnD,MAAM,YAAY,MAAM,MAAM,GAAG;IAEjC,MAAM,MAAM,YACR,CAAC,uCAAuC,EAAE,mBAAmB,OAAO,kCAAkC,CAAC,GACvG,CAAC,6CAA6C,CAAC;IAEnD,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,KAAK;YAC3B,SAAS;gBAAE,eAAe;YAAO;YACjC,OAAO;QACT;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,CAAC,kBAAkB,EAAE,IAAI,MAAM,EAAE;gBAAE,SAAS;YAAK,GAC1D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAQ,MAAM,IAAI,IAAI;QAI5B,MAAM,SAAS,KAAK,MAAM,IAAI,EAAE;QAChC,IAAI,OAAO,MAAM,KAAK,GAAG;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,yCAAyC;QACzC,MAAM,QAAQ,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,OAAO,MAAM,EAAE;QAC/D,MAAM,WAAW,MAAM,GAAG,EAAE,WAAW,MAAM,GAAG,EAAE,YAAY;QAC9D,MAAM,YAAY,MAAM,GAAG;QAC3B,MAAM,eAAe,MAAM,YAAY;QAEvC,IAAI,CAAC,UAAU;YACb,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAuB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;YAAU;YAAW;QAAa;IAC/D,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAmC,GAC5C;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}