{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/stores/theme-store.ts"],"sourcesContent":["import { create } from \"zustand\";\r\nimport { persist } from \"zustand/middleware\";\r\n\r\nexport type ThemeMode = \"auto\" | \"light\" | \"dark\";\r\n\r\ntype ThemeStore = {\r\n  mode: ThemeMode;\r\n  setMode: (mode: ThemeMode) => void;\r\n  resolved: \"light\" | \"dark\";\r\n  setResolved: (resolved: \"light\" | \"dark\") => void;\r\n};\r\n\r\nexport const useThemeStore = create<ThemeStore>()(\r\n  persist(\r\n    (set) => ({\r\n      mode: \"auto\",\r\n      resolved: \"light\",\r\n      setMode: (mode) => set({ mode }),\r\n      setResolved: (resolved) => set({ resolved }),\r\n    }),\r\n    { name: \"dashboard-theme\" }\r\n  )\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAWO,MAAM,gBAAgB,IAAA,kJAAM,IACjC,IAAA,wJAAO,EACL,CAAC,MAAQ,CAAC;QACR,MAAM;QACN,UAAU;QACV,SAAS,CAAC,OAAS,IAAI;gBAAE;YAAK;QAC9B,aAAa,CAAC,WAAa,IAAI;gBAAE;YAAS;IAC5C,CAAC,GACD;IAAE,MAAM;AAAkB","debugId":null}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/theme-provider.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useThemeStore } from \"@/stores/theme-store\";\r\nimport { useCallback, useEffect } from \"react\";\r\n\r\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\r\n  const { mode, resolved, setResolved } = useThemeStore();\r\n\r\n  const applyTheme = useCallback(() => {\r\n    const root = document.documentElement;\r\n    let next: \"light\" | \"dark\" = resolved;\r\n\r\n    if (mode === \"auto\") {\r\n      next =\r\n        typeof window !== \"undefined\" &&\r\n        window.matchMedia(\"(prefers-color-scheme: dark)\").matches\r\n          ? \"dark\"\r\n          : \"light\";\r\n    } else {\r\n      next = mode;\r\n    }\r\n\r\n    root.classList.remove(\"light\", \"dark\");\r\n    root.classList.add(next);\r\n    setResolved(next);\r\n  }, [mode, resolved, setResolved]);\r\n\r\n  useEffect(() => {\r\n    applyTheme();\r\n  }, [applyTheme]);\r\n\r\n  useEffect(() => {\r\n    if (mode !== \"auto\") return;\r\n    const mq = window.matchMedia(\"(prefers-color-scheme: dark)\");\r\n    const handler = () => applyTheme();\r\n    mq.addEventListener(\"change\", handler);\r\n    return () => mq.removeEventListener(\"change\", handler);\r\n  }, [mode, applyTheme]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen transition-theme duration-theme\" data-theme={resolved}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKO,SAAS,cAAc,EAAE,QAAQ,EAAiC;IACvE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,GAAG,IAAA,gJAAa;IAErD,MAAM,aAAa,IAAA,oNAAW,EAAC;QAC7B,MAAM,OAAO,SAAS,eAAe;QACrC,IAAI,OAAyB;QAE7B,IAAI,SAAS,QAAQ;YACnB,OACE,gBAAkB,eAClB,OAAO,UAAU,CAAC,gCAAgC,OAAO,GACrD,0BACA;QACR,OAAO;YACL,OAAO;QACT;QAEA,KAAK,SAAS,CAAC,MAAM,CAAC,SAAS;QAC/B,KAAK,SAAS,CAAC,GAAG,CAAC;QACnB,YAAY;IACd,GAAG;QAAC;QAAM;QAAU;KAAY;IAEhC,IAAA,kNAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAW;IAEf,IAAA,kNAAS,EAAC;QACR,IAAI,SAAS,QAAQ;QACrB,MAAM,KAAK,OAAO,UAAU,CAAC;QAC7B,MAAM,UAAU,IAAM;QACtB,GAAG,gBAAgB,CAAC,UAAU;QAC9B,OAAO,IAAM,GAAG,mBAAmB,CAAC,UAAU;IAChD,GAAG;QAAC;QAAM;KAAW;IAErB,qBACE,8OAAC;QAAI,WAAU;QAA+C,cAAY;kBACvE;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/stores/screensaver-store.ts"],"sourcesContent":["const STORAGE_KEY_DELAY = \"dashboard.screensaverDelaySeconds\";\r\nconst STORAGE_KEY_LEGACY_MINUTES = \"dashboard.screensaverMinutes\";\r\nconst STORAGE_KEY_BACKGROUND = \"dashboard.screensaverBackground\";\r\n\r\n/** Screensaver timeout in seconden. 0 = disabled. */\r\nexport function getScreensaverDelaySeconds(): number {\r\n  if (typeof window === \"undefined\") return 0;\r\n  try {\r\n    let v = localStorage.getItem(STORAGE_KEY_DELAY);\r\n    if (v === null) {\r\n      const legacy = localStorage.getItem(STORAGE_KEY_LEGACY_MINUTES);\r\n      if (legacy !== null) {\r\n        const min = parseInt(legacy, 10);\r\n        if (Number.isFinite(min) && min >= 0) {\r\n          const sec = min * 60;\r\n          localStorage.setItem(STORAGE_KEY_DELAY, String(sec));\r\n          localStorage.removeItem(STORAGE_KEY_LEGACY_MINUTES);\r\n          return sec;\r\n        }\r\n      }\r\n      return 0;\r\n    }\r\n    const n = parseInt(v, 10);\r\n    return Number.isFinite(n) && n >= 0 ? n : 0;\r\n  } catch {\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport function setScreensaverDelaySeconds(seconds: number): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_DELAY, String(Math.max(0, Math.round(seconds))));\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\n/** Screensaver background image URL. Empty string = geen afbeelding. */\r\nexport function getScreensaverBackgroundImage(): string {\r\n  if (typeof window === \"undefined\") return \"\";\r\n  try {\r\n    const v = localStorage.getItem(STORAGE_KEY_BACKGROUND);\r\n    return typeof v === \"string\" ? v : \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function setScreensaverBackgroundImage(url: string): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_BACKGROUND, url || \"\");\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\nconst STORAGE_KEY_CLOCK24 = \"dashboard.screensaverClock24h\";\r\n\r\n/** Klok 24-uurs (true) of 12-uurs am/pm (false). Default true. */\r\nexport function getScreensaverClock24h(): boolean {\r\n  if (typeof window === \"undefined\") return true;\r\n  try {\r\n    const v = localStorage.getItem(STORAGE_KEY_CLOCK24);\r\n    if (v === \"false\") return false;\r\n    if (v === \"true\") return true;\r\n    return true;\r\n  } catch {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport function setScreensaverClock24h(value: boolean): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_CLOCK24, value ? \"true\" : \"false\");\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\nconst STORAGE_KEY_WEATHER_ENTITY = \"dashboard.screensaverWeatherEntityId\";\r\n\r\n/** Weather entity voor screensaver (bijv. weather.home). Leeg = fallback naar header-temperatuurentity. */\r\nexport function getScreensaverWeatherEntityId(): string | null {\r\n  if (typeof window === \"undefined\") return null;\r\n  try {\r\n    const v = localStorage.getItem(STORAGE_KEY_WEATHER_ENTITY);\r\n    return v && v.length > 0 ? v : null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function setScreensaverWeatherEntityId(entityId: string | null): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_WEATHER_ENTITY, entityId ?? \"\");\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\nconst STORAGE_KEY_PEXELS_ENABLED = \"dashboard.screensaverPexelsEnabled\";\r\nconst STORAGE_KEY_PEXELS_QUERY = \"dashboard.screensaverPexelsQuery\";\r\nconst STORAGE_KEY_PEXELS_API_KEY = \"dashboard.screensaverPexelsApiKey\";\r\n\r\n/** Pexels-foto's gebruiken als screensaver-achtergrond (alleen als er geen custom afbeelding is). */\r\nexport function getScreensaverPexelsEnabled(): boolean {\r\n  if (typeof window === \"undefined\") return false;\r\n  try {\r\n    return localStorage.getItem(STORAGE_KEY_PEXELS_ENABLED) === \"true\";\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function setScreensaverPexelsEnabled(enabled: boolean): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_PEXELS_ENABLED, enabled ? \"true\" : \"false\");\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\n/** Zoekterm voor Pexels (bijv. \"nature landscape\", \"mountains\"). */\r\nexport function getScreensaverPexelsQuery(): string {\r\n  if (typeof window === \"undefined\") return \"nature landscape\";\r\n  try {\r\n    const v = localStorage.getItem(STORAGE_KEY_PEXELS_QUERY);\r\n    return typeof v === \"string\" && v.trim() ? v.trim() : \"nature landscape\";\r\n  } catch {\r\n    return \"nature landscape\";\r\n  }\r\n}\r\n\r\nexport function setScreensaverPexelsQuery(query: string): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_PEXELS_QUERY, query.trim() || \"nature landscape\");\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n\r\n/** Pexels API-key (gratis op pexels.com/api). Opgeslagen lokaal, niet op de server. */\r\nexport function getScreensaverPexelsApiKey(): string {\r\n  if (typeof window === \"undefined\") return \"\";\r\n  try {\r\n    const v = localStorage.getItem(STORAGE_KEY_PEXELS_API_KEY);\r\n    return typeof v === \"string\" ? v : \"\";\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function setScreensaverPexelsApiKey(apiKey: string): void {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY_PEXELS_API_KEY, apiKey.trim());\r\n    window.dispatchEvent(new CustomEvent(\"screensaver-setting-changed\"));\r\n  } catch {\r\n    // ignore\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,oBAAoB;AAC1B,MAAM,6BAA6B;AACnC,MAAM,yBAAyB;AAGxB,SAAS;IACd,wCAAmC,OAAO;;;AAqB5C;AAEO,SAAS,2BAA2B,OAAe;IACxD,IAAI;QACF,aAAa,OAAO,CAAC,mBAAmB,OAAO,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC;QACtE,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF;AAGO,SAAS;IACd,wCAAmC,OAAO;;;AAO5C;AAEO,SAAS,8BAA8B,GAAW;IACvD,IAAI;QACF,aAAa,OAAO,CAAC,wBAAwB,OAAO;QACpD,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF;AAEA,MAAM,sBAAsB;AAGrB,SAAS;IACd,wCAAmC,OAAO;;;AAS5C;AAEO,SAAS,uBAAuB,KAAc;IACnD,IAAI;QACF,aAAa,OAAO,CAAC,qBAAqB,QAAQ,SAAS;QAC3D,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF;AAEA,MAAM,6BAA6B;AAG5B,SAAS;IACd,wCAAmC,OAAO;;;AAO5C;AAEO,SAAS,8BAA8B,QAAuB;IACnE,IAAI;QACF,aAAa,OAAO,CAAC,4BAA4B,YAAY;QAC7D,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF;AAEA,MAAM,6BAA6B;AACnC,MAAM,2BAA2B;AACjC,MAAM,6BAA6B;AAG5B,SAAS;IACd,wCAAmC,OAAO;;;AAM5C;AAEO,SAAS,4BAA4B,OAAgB;IAC1D,IAAI;QACF,aAAa,OAAO,CAAC,4BAA4B,UAAU,SAAS;QACpE,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF;AAGO,SAAS;IACd,wCAAmC,OAAO;;;AAO5C;AAEO,SAAS,0BAA0B,KAAa;IACrD,IAAI;QACF,aAAa,OAAO,CAAC,0BAA0B,MAAM,IAAI,MAAM;QAC/D,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF;AAGO,SAAS;IACd,wCAAmC,OAAO;;;AAO5C;AAEO,SAAS,2BAA2B,MAAc;IACvD,IAAI;QACF,aAAa,OAAO,CAAC,4BAA4B,OAAO,IAAI;QAC5D,OAAO,aAAa,CAAC,IAAI,YAAY;IACvC,EAAE,OAAM;IACN,SAAS;IACX;AACF","debugId":null}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/stores/entity-state-store.ts"],"sourcesContent":["import { create } from \"zustand\";\n\nexport type EntityState = {\n  entity_id: string;\n  state: string;\n  attributes: Record<string, unknown>;\n};\n\ntype EntityStateStore = {\n  states: Record<string, EntityState>;\n  updatedAt: number | null;\n  error: string | null;\n  setStates: (entities: EntityState[]) => void;\n  /** Optimistic update voor één entity (bijv. direct aan/uit tonen). */\n  updateEntityState: (entityId: string, patch: Partial<Pick<EntityState, \"state\" | \"attributes\">>) => void;\n  setError: (error: string | null) => void;\n  getState: (entityId: string) => EntityState | undefined;\n  isOffline: () => boolean;\n};\n\nexport const useEntityStateStore = create<EntityStateStore>((set, get) => ({\n  states: {},\n  updatedAt: null,\n  error: null,\n  setStates: (entities) => {\n    const states: Record<string, EntityState> = {};\n    for (const e of entities) {\n      states[e.entity_id] = e;\n    }\n    set({ states, updatedAt: Date.now(), error: null });\n  },\n  updateEntityState: (entityId, patch) => {\n    const current = get().states[entityId];\n    if (!current) return;\n    set({\n      states: {\n        ...get().states,\n        [entityId]: { ...current, ...patch },\n      },\n      updatedAt: Date.now(),\n    });\n  },\n  setError: (error) => set({ error }),\n  getState: (entityId) => get().states[entityId],\n  isOffline: () => get().error != null,\n}));\n"],"names":[],"mappings":";;;;AAAA;;AAoBO,MAAM,sBAAsB,IAAA,kJAAM,EAAmB,CAAC,KAAK,MAAQ,CAAC;QACzE,QAAQ,CAAC;QACT,WAAW;QACX,OAAO;QACP,WAAW,CAAC;YACV,MAAM,SAAsC,CAAC;YAC7C,KAAK,MAAM,KAAK,SAAU;gBACxB,MAAM,CAAC,EAAE,SAAS,CAAC,GAAG;YACxB;YACA,IAAI;gBAAE;gBAAQ,WAAW,KAAK,GAAG;gBAAI,OAAO;YAAK;QACnD;QACA,mBAAmB,CAAC,UAAU;YAC5B,MAAM,UAAU,MAAM,MAAM,CAAC,SAAS;YACtC,IAAI,CAAC,SAAS;YACd,IAAI;gBACF,QAAQ;oBACN,GAAG,MAAM,MAAM;oBACf,CAAC,SAAS,EAAE;wBAAE,GAAG,OAAO;wBAAE,GAAG,KAAK;oBAAC;gBACrC;gBACA,WAAW,KAAK,GAAG;YACrB;QACF;QACA,UAAU,CAAC,QAAU,IAAI;gBAAE;YAAM;QACjC,UAAU,CAAC,WAAa,MAAM,MAAM,CAAC,SAAS;QAC9C,WAAW,IAAM,MAAM,KAAK,IAAI;IAClC,CAAC","debugId":null}},
    {"offset": {"line": 270, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/screensaver.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useCallback } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport {\r\n  Cloud,\r\n  CloudFog,\r\n  CloudLightning,\r\n  CloudRain,\r\n  CloudSnow,\r\n  Moon,\r\n  Sun,\r\n  Wind,\r\n} from \"lucide-react\";\r\nimport { getScreensaverDelaySeconds, getScreensaverBackgroundImage, getScreensaverClock24h, getScreensaverWeatherEntityId, getScreensaverPexelsEnabled, getScreensaverPexelsQuery, getScreensaverPexelsApiKey } from \"@/stores/screensaver-store\";\r\nimport { useEntityStateStore } from \"@/stores/entity-state-store\";\r\n\r\n/** Standaard achtergrond wanneer er geen afbeelding is geüpload (zet bestand in public/default-screensaver.png). */\r\nconst DEFAULT_SCREENSAVER_IMAGE = \"/default-screensaver.png\";\r\n\r\nconst ACTIVITY_EVENTS = [\"mousemove\", \"mousedown\", \"keydown\", \"touchstart\", \"scroll\", \"click\"] as const;\r\n\r\nfunction useIdleScreensaver() {\r\n  const [active, setActive] = useState(false);\r\n  const [timeoutSeconds, setTimeoutSeconds] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const sec = getScreensaverDelaySeconds();\r\n    setTimeoutSeconds(sec);\r\n    const onSettingChange = () => setTimeoutSeconds(getScreensaverDelaySeconds());\r\n    const onActivate = () => setActive(true);\r\n    window.addEventListener(\"screensaver-setting-changed\", onSettingChange);\r\n    window.addEventListener(\"screensaver-activate\", onActivate);\r\n    return () => {\r\n      window.removeEventListener(\"screensaver-setting-changed\", onSettingChange);\r\n      window.removeEventListener(\"screensaver-activate\", onActivate);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (timeoutSeconds <= 0) {\r\n      setActive(false);\r\n      return;\r\n    }\r\n    const delayMs = timeoutSeconds * 1000;\r\n    let timeoutId: ReturnType<typeof setTimeout> | null = null;\r\n\r\n    const resetTimer = () => {\r\n      setActive(false);\r\n      if (timeoutId) clearTimeout(timeoutId);\r\n      timeoutId = setTimeout(() => setActive(true), delayMs);\r\n    };\r\n\r\n    resetTimer();\r\n\r\n    const onActivity = () => resetTimer();\r\n    for (const ev of ACTIVITY_EVENTS) {\r\n      window.addEventListener(ev, onActivity, { passive: true });\r\n    }\r\n\r\n    return () => {\r\n      for (const ev of ACTIVITY_EVENTS) {\r\n        window.removeEventListener(ev, onActivity);\r\n      }\r\n      if (timeoutId) clearTimeout(timeoutId);\r\n    };\r\n  }, [timeoutSeconds]);\r\n\r\n  return { active, setActive };\r\n}\r\n\r\nfunction ScreensaverWeatherIcon({ state }: { state: string }) {\r\n  const s = state?.toLowerCase() ?? \"\";\r\n  const iconClass = \"h-6 w-6 shrink-0 text-white/90\";\r\n  if (s === \"sunny\" || s === \"clear\") return <Sun className={iconClass} aria-hidden />;\r\n  if (s === \"clear-night\") return <Moon className={iconClass} aria-hidden />;\r\n  if (s === \"fog\" || s === \"mist\") return <CloudFog className={iconClass} aria-hidden />;\r\n  if (s === \"rainy\" || s === \"pouring\" || s === \"hail\") return <CloudRain className={iconClass} aria-hidden />;\r\n  if (s === \"snowy\" || s === \"snowy-rainy\") return <CloudSnow className={iconClass} aria-hidden />;\r\n  if (s === \"lightning\" || s === \"lightning-rainy\") return <CloudLightning className={iconClass} aria-hidden />;\r\n  if (s === \"windy\" || s === \"windy-variant\") return <Wind className={iconClass} aria-hidden />;\r\n  if (s === \"cloudy\" || s === \"partlycloudy\" || s === \"exceptional\") return <Cloud className={iconClass} aria-hidden />;\r\n  return <Cloud className={iconClass} aria-hidden />;\r\n}\r\n\r\nfunction ScreensaverWeather() {\r\n  const entityId =\r\n    getScreensaverWeatherEntityId() ??\r\n    (typeof window !== \"undefined\" ? localStorage.getItem(\"dashboard.headerTemperatureEntityId\") : null) ??\r\n    \"weather.home\";\r\n  const entity = useEntityStateStore((s) => s.getState(entityId));\r\n\r\n  const condition = (entity?.state as string) ?? \"\";\r\n  const temperature =\r\n    entity?.attributes?.temperature != null\r\n      ? Number(entity.attributes.temperature)\r\n      : (entity?.state != null && entityId.startsWith(\"sensor.\") ? Number(entity.state) : undefined);\r\n  const tempStr =\r\n    temperature != null && !Number.isNaN(temperature)\r\n      ? `${Math.round(temperature)}°`\r\n      : null;\r\n\r\n  if (!tempStr && !condition) return null;\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 text-white/90 drop-shadow-md\">\r\n      {(condition || entityId.startsWith(\"weather.\")) && (\r\n        <ScreensaverWeatherIcon state={condition} />\r\n      )}\r\n      {tempStr && (\r\n        <span className=\"text-xl font-light tabular-nums\">{tempStr}</span>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ScreensaverClock() {\r\n  const [time, setTime] = useState(() => new Date());\r\n  const use24h = getScreensaverClock24h();\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => setTime(new Date()), 1000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const timeStr = use24h\r\n    ? `${time.getHours().toString().padStart(2, \"0\")}:${time.getMinutes().toString().padStart(2, \"0\")}`\r\n    : `${(time.getHours() % 12 || 12)}:${time.getMinutes().toString().padStart(2, \"0\")}`;\r\n  const ampm = use24h ? null : (time.getHours() < 12 ? \"am\" : \"pm\");\r\n\r\n  const dateStr = time.toLocaleDateString(\"nl-NL\", {\r\n    weekday: \"long\",\r\n    day: \"numeric\",\r\n    month: \"long\",\r\n  });\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-end gap-1\">\r\n      <time\r\n        dateTime={time.toISOString()}\r\n        className=\"text-5xl sm:text-6xl font-light tabular-nums text-white/90 drop-shadow-md\"\r\n      >\r\n        {timeStr}\r\n        {ampm != null && (\r\n          <span className=\"ml-1.5 text-lg sm:text-xl font-normal text-white/70\">\r\n            {ampm}\r\n          </span>\r\n        )}\r\n      </time>\r\n      <span className=\"text-sm text-white/50 tabular-nums\">{dateStr}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ScreensaverOverlay({ onDismiss }: { onDismiss: () => void }) {\r\n  const customBg = getScreensaverBackgroundImage();\r\n  const pexelsEnabled = getScreensaverPexelsEnabled();\r\n  const pexelsQuery = getScreensaverPexelsQuery();\r\n  const [pexelsImage, setPexelsImage] = useState<string | null>(null);\r\n  const [pexelsAttribution, setPexelsAttribution] = useState<{ url: string; photographer: string } | null>(null);\r\n  const [imageFailed, setImageFailed] = useState(false);\r\n  const [pexelsError, setPexelsError] = useState(false);\r\n\r\n  const pexelsApiKey = getScreensaverPexelsApiKey();\r\n\r\n  useEffect(() => {\r\n    if (customBg || !pexelsEnabled || !pexelsApiKey) return;\r\n    setPexelsError(false);\r\n    fetch(`/api/pexels/photo?query=${encodeURIComponent(pexelsQuery)}`, {\r\n      headers: { \"X-Pexels-Api-Key\": pexelsApiKey },\r\n    })\r\n      .then((r) => r.json())\r\n      .then((data) => {\r\n        if (data?.imageUrl) {\r\n          setPexelsImage(data.imageUrl);\r\n          setPexelsAttribution(data.pexelsUrl && data.photographer ? { url: data.pexelsUrl, photographer: data.photographer } : null);\r\n        } else {\r\n          setPexelsError(true);\r\n        }\r\n      })\r\n      .catch(() => setPexelsError(true));\r\n  }, [customBg, pexelsEnabled, pexelsQuery, pexelsApiKey]);\r\n\r\n  const backgroundImage = customBg || pexelsImage || DEFAULT_SCREENSAVER_IMAGE;\r\n  const useGradient = imageFailed || (pexelsEnabled && !customBg && (pexelsError && !pexelsImage || !pexelsApiKey));\r\n\r\n  return (\r\n    <div\r\n      role=\"button\"\r\n      tabIndex={0}\r\n      aria-label=\"Screensaver aanraken om te sluiten\"\r\n      className=\"fixed inset-0 z-[9999] flex items-end justify-end p-8 cursor-pointer focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50\"\r\n      style={\r\n        useGradient\r\n          ? { background: \"linear-gradient(to bottom right, #111827, #1f2937, #000)\" }\r\n          : undefined\r\n      }\r\n      onClick={onDismiss}\r\n      onKeyDown={(e) => {\r\n        if (e.key === \"Enter\" || e.key === \" \") onDismiss();\r\n      }}\r\n    >\r\n      {!useGradient && (\r\n        <>\r\n          <div\r\n            className=\"absolute inset-0 bg-cover bg-center bg-no-repeat\"\r\n            style={{ backgroundImage: `url(${backgroundImage})` }}\r\n            aria-hidden\r\n          />\r\n          <img\r\n            src={backgroundImage}\r\n            alt=\"\"\r\n            className=\"sr-only\"\r\n            onError={() => setImageFailed(true)}\r\n          />\r\n          <div className=\"absolute inset-0 bg-black/50\" aria-hidden />\r\n        </>\r\n      )}\r\n      <div className=\"relative z-10 flex flex-col items-end gap-4\">\r\n        <ScreensaverWeather />\r\n        <ScreensaverClock />\r\n        {pexelsAttribution && (\r\n          <a\r\n            href={pexelsAttribution.url}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className=\"text-xs text-white/50 hover:text-white/70 transition-colors\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            Photo by {pexelsAttribution.photographer} on Pexels\r\n          </a>\r\n        )}\r\n        {pexelsEnabled && !pexelsAttribution && !pexelsError && (\r\n          <a\r\n            href=\"https://www.pexels.com\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className=\"text-xs text-white/50 hover:text-white/70 transition-colors\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            Photos provided by Pexels\r\n          </a>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function ScreensaverProvider({ children }: { children: React.ReactNode }) {\r\n  const { active, setActive } = useIdleScreensaver();\r\n\r\n  const dismiss = useCallback(() => setActive(false), []);\r\n\r\n  return (\r\n    <>\r\n      {children}\r\n      {active &&\r\n        typeof document !== \"undefined\" &&\r\n        createPortal(\r\n          <ScreensaverOverlay onDismiss={dismiss} />,\r\n          document.body\r\n        )}\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 665, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/hooks/use-entity-state.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport { useEntityStateStore } from \"@/stores/entity-state-store\";\r\n\r\nconst POLL_INTERVAL_MS = 5000;\r\n\r\n/**\r\n * Poll GET /api/ha/state and update entity state store.\r\n * Call once from a provider or dashboard layout so widgets can read live state.\r\n */\r\nexport function useEntityStatePolling(connectionId?: string) {\r\n  const setStates = useEntityStateStore((s) => s.setStates);\r\n  const setError = useEntityStateStore((s) => s.setError);\r\n  const intervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\r\n\r\n  useEffect(() => {\r\n    const url = connectionId\r\n      ? `/api/ha/state?connectionId=${encodeURIComponent(connectionId)}`\r\n      : \"/api/ha/state\";\r\n\r\n    function poll() {\r\n      fetch(url)\r\n        .then((res) => {\r\n          if (!res.ok) throw new Error(\"Fetch failed\");\r\n          return res.json();\r\n        })\r\n        .then((data) => {\r\n          if (Array.isArray(data)) setStates(data);\r\n        })\r\n        .catch(() => setError(\"No connection\"));\r\n    }\r\n\r\n    poll();\r\n    intervalRef.current = setInterval(poll, POLL_INTERVAL_MS);\r\n    return () => {\r\n      if (intervalRef.current) clearInterval(intervalRef.current);\r\n    };\r\n  }, [connectionId, setStates, setError]);\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKA,MAAM,mBAAmB;AAMlB,SAAS,sBAAsB,YAAqB;IACzD,MAAM,YAAY,IAAA,gKAAmB,EAAC,CAAC,IAAM,EAAE,SAAS;IACxD,MAAM,WAAW,IAAA,gKAAmB,EAAC,CAAC,IAAM,EAAE,QAAQ;IACtD,MAAM,cAAc,IAAA,+MAAM,EAAwC;IAElE,IAAA,kNAAS,EAAC;QACR,MAAM,MAAM,eACR,CAAC,2BAA2B,EAAE,mBAAmB,eAAe,GAChE;QAEJ,SAAS;YACP,MAAM,KACH,IAAI,CAAC,CAAC;gBACL,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;gBAC7B,OAAO,IAAI,IAAI;YACjB,GACC,IAAI,CAAC,CAAC;gBACL,IAAI,MAAM,OAAO,CAAC,OAAO,UAAU;YACrC,GACC,KAAK,CAAC,IAAM,SAAS;QAC1B;QAEA;QACA,YAAY,OAAO,GAAG,YAAY,MAAM;QACxC,OAAO;YACL,IAAI,YAAY,OAAO,EAAE,cAAc,YAAY,OAAO;QAC5D;IACF,GAAG;QAAC;QAAc;QAAW;KAAS;AACxC","debugId":null}},
    {"offset": {"line": 704, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/providers.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\r\nimport { useState } from \"react\";\r\nimport { ThemeProvider } from \"./theme-provider\";\r\nimport { ScreensaverProvider } from \"./screensaver\";\r\nimport { useEntityStatePolling } from \"@/hooks/use-entity-state\";\r\n\r\nexport function Providers({ children }: { children: React.ReactNode }) {\r\n  const [queryClient] = useState(\r\n    () =>\r\n      new QueryClient({\r\n        defaultOptions: {\r\n          queries: { staleTime: 60 * 1000 },\r\n        },\r\n      })\r\n  );\r\n\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      <ThemeProvider>\r\n        <EntityStatePoller />\r\n        <ScreensaverProvider>{children}</ScreensaverProvider>\r\n      </ThemeProvider>\r\n    </QueryClientProvider>\r\n  );\r\n}\r\n\r\nfunction EntityStatePoller() {\r\n  useEntityStatePolling();\r\n  return null;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACnE,MAAM,CAAC,YAAY,GAAG,IAAA,iNAAQ,EAC5B,IACE,IAAI,4LAAW,CAAC;YACd,gBAAgB;gBACd,SAAS;oBAAE,WAAW,KAAK;gBAAK;YAClC;QACF;IAGJ,qBACE,8OAAC,6MAAmB;QAAC,QAAQ;kBAC3B,cAAA,8OAAC,wJAAa;;8BACZ,8OAAC;;;;;8BACD,8OAAC,wJAAmB;8BAAE;;;;;;;;;;;;;;;;;AAI9B;AAEA,SAAS;IACP,IAAA,+JAAqB;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 784, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/lib/onboarding-completed.ts"],"sourcesContent":["const KEY = \"onboarding_completed\";\r\n\r\nexport function setOnboardingCompleted(): void {\r\n  if (typeof window === \"undefined\") return;\r\n  window.localStorage.setItem(KEY, \"true\");\r\n}\r\n\r\nexport function getOnboardingCompleted(): boolean {\r\n  if (typeof window === \"undefined\") return false;\r\n  return window.localStorage.getItem(KEY) === \"true\";\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,MAAM;AAEL,SAAS;IACd,wCAAmC;;;AAErC;AAEO,SAAS;IACd,wCAAmC,OAAO;;;AAE5C","debugId":null}},
    {"offset": {"line": 805, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/onboarding-guard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getOnboardingCompleted, setOnboardingCompleted } from \"@/lib/onboarding-completed\";\r\n\r\nexport function OnboardingGuard({ children }: { children: React.ReactNode }) {\r\n  const pathname = usePathname();\r\n  const router = useRouter();\r\n  const [allowed, setAllowed] = useState<boolean | null>(null);\r\n\r\n  useEffect(() => {\r\n    const completed = getOnboardingCompleted();\r\n    const isOnboardingStart = pathname === \"/onboarding/start\";\r\n    const isOnboardingWizard = pathname === \"/onboarding\";\r\n\r\n    if (completed || isOnboardingStart || isOnboardingWizard) {\r\n      setAllowed(true);\r\n      return;\r\n    }\r\n\r\n    // Geen onboarding-flag in localStorage: check of er al een dashboard is (bijv. eerste start na deploy met bestaande data)\r\n    fetch(\"/api/dashboard\")\r\n      .then((r) => r.json())\r\n      .then((d) => {\r\n        if (d?.id) {\r\n          setOnboardingCompleted();\r\n          setAllowed(true);\r\n          if (pathname === \"/\" || pathname === \"/dashboards\") {\r\n            router.replace(`/dashboards/${d.id}`);\r\n          }\r\n        } else {\r\n          router.replace(\"/onboarding/start\");\r\n          setAllowed(false);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        router.replace(\"/onboarding/start\");\r\n        setAllowed(false);\r\n      });\r\n  }, [pathname, router]);\r\n\r\n  if (allowed === null || !allowed) {\r\n    return (\r\n      <div className=\"flex min-h-screen items-center justify-center bg-page-light dark:bg-dark-page\">\r\n        <div className=\"h-8 w-8 animate-spin rounded-full border-2 border-accent-yellow dark:border-accent-green border-t-transparent\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMO,SAAS,gBAAgB,EAAE,QAAQ,EAAiC;IACzE,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAiB;IAEvD,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY,IAAA,+JAAsB;QACxC,MAAM,oBAAoB,aAAa;QACvC,MAAM,qBAAqB,aAAa;QAExC,IAAI,aAAa,qBAAqB,oBAAoB;YACxD,WAAW;YACX;QACF;QAEA,0HAA0H;QAC1H,MAAM,kBACH,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,IAClB,IAAI,CAAC,CAAC;YACL,IAAI,GAAG,IAAI;gBACT,IAAA,+JAAsB;gBACtB,WAAW;gBACX,IAAI,aAAa,OAAO,aAAa,eAAe;oBAClD,OAAO,OAAO,CAAC,CAAC,YAAY,EAAE,EAAE,EAAE,EAAE;gBACtC;YACF,OAAO;gBACL,OAAO,OAAO,CAAC;gBACf,WAAW;YACb;QACF,GACC,KAAK,CAAC;YACL,OAAO,OAAO,CAAC;YACf,WAAW;QACb;IACJ,GAAG;QAAC;QAAU;KAAO;IAErB,IAAI,YAAY,QAAQ,CAAC,SAAS;QAChC,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 874, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HiddevanBrussel/.cursor/dashboard/src/components/page-background.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { useThemeStore } from \"@/stores/theme-store\";\r\n\r\ntype BackgroundData = {\r\n  background: string | null;\r\n  backgroundLight: string | null;\r\n  backgroundDark: string | null;\r\n};\r\n\r\nfunction fetchBackground(): Promise<BackgroundData> {\r\n  return fetch(\"/api/dashboard\")\r\n    .then((r) => r.json())\r\n    .then((d) => ({\r\n      background: d?.background ?? null,\r\n      backgroundLight: d?.backgroundLight ?? null,\r\n      backgroundDark: d?.backgroundDark ?? null,\r\n    }))\r\n    .catch(() => ({ background: null, backgroundLight: null, backgroundDark: null }));\r\n}\r\n\r\nconst PageBackgroundContext = createContext<string | null>(null);\r\n\r\nexport function usePageBackground() {\r\n  return useContext(PageBackgroundContext);\r\n}\r\n\r\nexport function PageBackgroundProvider({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  const [data, setData] = useState<BackgroundData>({\r\n    background: null,\r\n    backgroundLight: null,\r\n    backgroundDark: null,\r\n  });\r\n  const resolved = useThemeStore((s) => s.resolved);\r\n\r\n  useEffect(() => {\r\n    fetchBackground().then(setData);\r\n    const onUpdate = () => fetchBackground().then(setData);\r\n    window.addEventListener(\"page-background-changed\", onUpdate);\r\n    return () => window.removeEventListener(\"page-background-changed\", onUpdate);\r\n  }, []);\r\n\r\n  const url =\r\n    (resolved === \"dark\" ? data.backgroundDark : data.backgroundLight) ??\r\n    data.background ??\r\n    null;\r\n\r\n  return (\r\n    <PageBackgroundContext.Provider value={url}>\r\n      {url ? (\r\n        <div\r\n          className=\"fixed inset-0 -z-10 bg-cover bg-center bg-no-repeat\"\r\n          style={{ backgroundImage: `url(${url})` }}\r\n          aria-hidden\r\n        />\r\n      ) : null}\r\n      {children}\r\n    </PageBackgroundContext.Provider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAWA,SAAS;IACP,OAAO,MAAM,kBACV,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,IAClB,IAAI,CAAC,CAAC,IAAM,CAAC;YACZ,YAAY,GAAG,cAAc;YAC7B,iBAAiB,GAAG,mBAAmB;YACvC,gBAAgB,GAAG,kBAAkB;QACvC,CAAC,GACA,KAAK,CAAC,IAAM,CAAC;YAAE,YAAY;YAAM,iBAAiB;YAAM,gBAAgB;QAAK,CAAC;AACnF;AAEA,MAAM,sCAAwB,IAAA,sNAAa,EAAgB;AAEpD,SAAS;IACd,OAAO,IAAA,mNAAU,EAAC;AACpB;AAEO,SAAS,uBAAuB,EACrC,QAAQ,EAGT;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAiB;QAC/C,YAAY;QACZ,iBAAiB;QACjB,gBAAgB;IAClB;IACA,MAAM,WAAW,IAAA,gJAAa,EAAC,CAAC,IAAM,EAAE,QAAQ;IAEhD,IAAA,kNAAS,EAAC;QACR,kBAAkB,IAAI,CAAC;QACvB,MAAM,WAAW,IAAM,kBAAkB,IAAI,CAAC;QAC9C,OAAO,gBAAgB,CAAC,2BAA2B;QACnD,OAAO,IAAM,OAAO,mBAAmB,CAAC,2BAA2B;IACrE,GAAG,EAAE;IAEL,MAAM,MACJ,CAAC,aAAa,SAAS,KAAK,cAAc,GAAG,KAAK,eAAe,KACjE,KAAK,UAAU,IACf;IAEF,qBACE,8OAAC,sBAAsB,QAAQ;QAAC,OAAO;;YACpC,oBACC,8OAAC;gBACC,WAAU;gBACV,OAAO;oBAAE,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;gBAAC;gBACxC,aAAW;;;;;uBAEX;YACH;;;;;;;AAGP","debugId":null}}]
}